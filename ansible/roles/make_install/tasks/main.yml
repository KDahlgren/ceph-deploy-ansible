#- name: "copy setup files"
#  copy:
#    src: "{{ item }}"
#    dest: "{{ local_home }}"
#    mode: '0644'
#  with_items:
#    - ./files/format-device.sh
#
#- name: "running format device"
#  shell: sh format-device.sh {{ this_user }} {{ format_device }} ;
#  ignore_errors: yes
#
#- name: "clone skyhook repo"
#  shell: |
#    cd "/mnt/{{ format_device }}" ;
#    rm -rf "/mnt/{{ format_device }}/skyhookdm-ceph/" ;
#    git clone https://github.com/uccross/skyhookdm-ceph.git
#
#- name: "setup skyhook repo"
#  shell: |
#    cd "/mnt/{{ format_device }}/skyhookdm-ceph" ;
#    git checkout skyhook-pdsw19 ;
#
#- name: "running install-deps"
#  shell: |
#    cd "/mnt/{{ format_device }}/skyhookdm-ceph" ;
#    ./install-deps.sh ;
#
#- name: "running do_cmake"
#  shell: |
#    cd "/mnt/{{ format_device }}/skyhookdm-ceph" ;
#    ./do_cmake.sh ;

- name: "running make"
  shell: |
    cd "/mnt/{{ format_device }}/skyhookdm-ceph/build" ;
    sudo make -j36 ;

- name: "running make install"
  shell: |
    cd "/mnt/{{ format_device }}/skyhookdm-ceph/build" ;
    sudo make install ;
